# üìö ML Optimization Best Practices

## üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –¥–ª—è –∫–æ–º–∞–Ω–¥—ã: —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ø—Ä–æ–º–ø—Ç–æ–≤, –º–µ—Ç—Ä–∏–∫–∏, –∫–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å A/B –∏ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ.  
–î–æ–∫—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å–ª—É–∂–∏—Ç—å:
- –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é VLM –∏ LLM –ø—Ä–æ–º–ø—Ç–æ–≤.
- –ß–µ–∫–ª–∏—Å—Ç–æ–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
- –ò—Å—Ç–æ—á–Ω–∏–∫–æ–º –º–µ—Ç—Ä–∏–∫ –∏ –ø—Ä–∞–≤–∏–ª –¥–ª—è A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
- –ñ—É—Ä–Ω–∞–ª–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π (changelog) –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤.

---

## üß± Baseline

### –ö–ª–∞—Å—Å—ã
**`LLaVAVision`**

  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `UC_VLM_PROMPT` –∏ –º–æ–¥–µ–ª—å `qwen2.5vl:3b` —á–µ—Ä–µ–∑ Ollama.
  –ó–∞–¥–∞—á–∞: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π, –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π.

**`MistralText`**

  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `UC_LLM_PROMPT` –∏ –º–æ–¥–µ–ª—å `mistral-small` —á–µ—Ä–µ–∑ Mistral API.
  –ó–∞–¥–∞—á–∞: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ü–µ–ø—Ç–æ–≤ –≤ —Å—Ç—Ä–æ–≥–æ–º JSON-—Ñ–æ—Ä–º–∞—Ç–µ —Å —É—á—ë—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π.  

---

## üìä –¢–∞–±–ª–∏—Ü–∞ –º–µ—Ç—Ä–∏–∫

| –ú–æ–¥–µ–ª—å       | F1     | Excess Ratio | Delay (sec) | Tokens | Duration (sec) | Dietary OK (%) | Difficulty OK (%) | Time OK (%) | Calories OK (%) |
|--------------|--------|---------------|--------------|--------|----------------|----------------|-------------------|-------------|------------------|
| vlm_prompt_a | 0.818  | 0.010         | 54.74        | ‚Äî      | ‚Äî              | ‚Äî              | ‚Äî                 | ‚Äî           | ‚Äî                |
| vlm_prompt_b | 0.861  | 0.000         | 54.48        | ‚Äî      | ‚Äî              | ‚Äî              | ‚Äî                 | ‚Äî           | ‚Äî                |
| llm_prompt_a | ‚Äî      | ‚Äî             | ‚Äî            | 487.8  | 4.92           | 79.2           | 75.0              | 75.0        | 75.0             |
| llm_prompt_b | ‚Äî      | ‚Äî             | ‚Äî            | 420.3  | 4.87           | 83.9           | 83.9              | 80.6        | 74.2             |

---

## ‚ùå –¢–∏–ø–æ–≤—ã–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–∏—á–∏–Ω—ã

- **–ö–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã (80 —Ç–æ–∫–µ–Ω–æ–≤):** —Å–±–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ API). ‚Üí –ò—Å–∫–ª—é—á–µ–Ω–æ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞.  
- **–ù–µ–≤–µ—Ä–Ω—ã–π `calorie_level`:** –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `calorie_content.kcal`. ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è —Ñ–æ—Ä–º—É–ª–∞ –≤ –ø—Ä–æ–º–ø—Ç.  
- **–ù–µ–≤–µ—Ä–Ω—ã–π `difficulty` –∏–ª–∏ `cooking_speed`:** –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `cooking_time`. ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.   

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–º–ø—Ç–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- `cooking_time` (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –º–∏–Ω—É—Ç—ã)  
- `difficulty` (–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏)  
- `cooking_speed` (–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏)  
- `calorie_content`: kcal, protein_g, fat_g, carb_g  
- `calorie_level` (–ø–æ kcal)  

### –ü—Ä–∞–≤–∏–ª–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

**`difficulty`**:  
  - –ª–µ–≥–∫–æ ‚â§ 20 –º–∏–Ω  
  - —Å—Ä–µ–¥–Ω–µ 21‚Äì40 –º–∏–Ω  
  - —Å–ª–æ–∂–Ω–æ > 40 –º–∏–Ω

 **`cooking_speed`**:
  - –ª–µ–≥–∫–æ ‚â§ 20 –º–∏–Ω  
  - —Å—Ä–µ–¥–Ω–µ 21‚Äì40 –º–∏–Ω  
  - —Å–ª–æ–∂–Ω–æ > 40 –º–∏–Ω
    
 **`calorie_level`**:
  - –Ω–∏–∑–∫–æ–∫–∞–ª–æ—Ä–∏–π–Ω–æ–µ < 300  
  - —Å—Ä–µ–¥–Ω–µ–∫–∞–ª–æ—Ä–∏–π–Ω–æ–µ 300‚Äì600  
  - –≤—ã—Å–æ–∫–æ–∫–∞–ª–æ—Ä–∏–π–Ω–æ–µ > 600  

### –ó–∞–ø—Ä–µ—Ç—ã
- ‚ùå Markdown, –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏  
- ‚ùå –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –≤–Ω–µ –≤—Ö–æ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å ‚Äî —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É –≤ `notes`)  

---

## üß™ –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–í—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:** —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—ã –ø—Ä–æ–º–ø—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, vlm_a vs vlm_b; llm_a vs llm_b).  
2. **–ó–∞–ø—É—Å–∫:** –ø—Ä–æ–≥–Ω–∞—Ç—å –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.  
3. **–°–±–æ—Ä –º–µ—Ç—Ä–∏–∫:**  
   - VLM: `vlm_f1`, `vlm_excess_ratio`, `vlm_duration_sec`  
   - LLM: `tokens`, `duration_sec`, `dietary_ok`, `difficulty_ok`, `time_ok`, `calories_ok`  
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –∏—Å–∫–ª—é—á–∏—Ç—å –æ—Ç–≤–µ—Ç—ã —Å `tokens=80`.  
5. **–ê–Ω–∞–ª–∏–∑:** —Å—Ä–∞–≤–Ω–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –ø–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –º–µ—Ç—Ä–∏–∫.  
6. **–§–∏–∫—Å–∞—Ü–∏—è:** –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å baseline –∏ –ø—Ä–∏—á–∏–Ω—ã –≤—ã–±–æ—Ä–∞.  

---

## üìù Changelog –ø—Ä–æ–º–ø—Ç–æ–≤

### VLM Prompt A

**v1**  
  - –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏: —É–±—Ä–∞—Ç—å –±—Ä–µ–Ω–¥—ã, —Å–æ—Ä—Ç–∞, —É—Ç–æ—á–Ω–µ–Ω–∏—è.  
  - –£–ø–∞–∫–æ–≤–∫–∞ ‚Üí —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–∫–æ—Ä–æ–±–∫–∞ —è–∏—Ü ‚Üí —è–π—Ü–∞, –±—É—Ç—ã–ª–∫–∞ –º–æ–ª–æ–∫–∞ ‚Üí –º–æ–ª–æ–∫–æ).  
  - –ß–∞—Å—Ç–∏ ‚Üí –±–∞–∑–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–∫—É—Ä–∏–Ω—ã–µ –∫—Ä—ã–ª—ã—à–∫–∏ ‚Üí –∫—É—Ä–∏—Ü–∞).  
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.  
  - –§–æ—Ä–º–∞—Ç: —Å—Ç—Ä–æ–≥–∏–π JSON –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ.  

---

### VLM Prompt B

**v1**  
  - –¶–µ–ª—å: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è `excess_ratio`.  
  - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞.  
  - –°—Ç—Ä–æ–≥–∏–π JSON-–≤—ã–≤–æ–¥.

**v2**  
  - –î–æ–±–∞–≤–ª–µ–Ω –∑–∞–ø—Ä–µ—Ç –Ω–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–µ —Å –º–µ—Å—Ç–æ–º —Ö—Ä–∞–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–±—É—Ç—ã–ª–∫–∞ –≤–æ–¥—ã¬ª ‚Üí ¬´–≤–æ–¥–∞¬ª).  
  - –£—Ç–æ—á–Ω–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π: –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.  
  - –°–æ—Ö—Ä–∞–Ω—ë–Ω —Å—Ç—Ä–æ–≥–∏–π JSON-–≤—ã–≤–æ–¥.

---

### LLM Prompt A

**v1**  
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–æ–≤–Ω–æ 3 —Ä–µ—Ü–µ–ø—Ç–æ–≤.  
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ö–æ–¥–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã.  
  - –†–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è (–≤–∞—Ä–∫–∞, –∂–∞—Ä–∫–∞, –∑–∞–ø–µ–∫–∞–Ω–∏–µ, —Ç—É—à–µ–Ω–∏–µ).  
  - –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `cooking_time`, `difficulty`, `cooking_speed`, `calorie_content`, `calorie_level`.  
  - –§–æ—Ä–º—É–ª—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å—Ç—Ä–æ–≥–æ –ø–æ –ø–æ—Ä–æ–≥–∞–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏.  
  - –§–æ—Ä–º–∞—Ç: —Å—Ç—Ä–æ–≥–∏–π JSON –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.  

---

## LLM Prompt B

**v1**  
  - –°—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ `calorie_level`, `difficulty`, `cooking_speed`.  
  - JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏.  
  - –ó–∞–ø—Ä–µ—Ç –ª–∏—à–Ω–∏—Ö –ø–æ–ª–µ–π –∏ Markdown.  
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —à–∞–≥–æ–≤ –∏ —Ç–æ–∫–µ–Ω–æ–≤.

**v2**  
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ —Ä–µ—Ü–µ–ø—Ç–∞ (`calorie_content`).

**v3**  
  - –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π —Ç–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω.  
