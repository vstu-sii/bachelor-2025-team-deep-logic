# Актуальная архитектура (C4)

## Context
![Context](../generated/C4_context.png)

## Containers
![Containers](../generated/C4_container.png)


---

### ADR‑1: Backend API на FastAPI
**Решение:** выбран FastAPI для реализации Backend API.  
**Причины:** простота разработки, поддержка асинхронности, встроенная документация OpenAPI/Swagger.  
**Альтернативы:** Flask (менее удобен для async), Django (избыточен для прототипа).  

---

### ADR‑2: RabbitMQ для асинхронного взаимодействия
**Решение:** RabbitMQ используется как очередь сообщений.  
**Причины:** устойчивость, поддержка AMQP, возможность горизонтального масштабирования.  
**Альтернативы:** Kafka (избыточен для прототипа), Redis Streams (менее надёжен для сложных сценариев).  

---

### ADR‑3: Model Manager внутри Backend API
**Решение:** Model Manager интегрирован в Backend API, а не вынесен в отдельный контейнер.  
**Причины:** упрощение архитектуры, меньше сервисов для поддержки, быстрее для прототипа.  
**Альтернативы:** вынести в отдельный контейнер (даёт независимое масштабирование, но усложняет инфраструктуру).  

---

### ADR‑4: Ollama как VLM
**Решение:** Ollama выбран для распознавания изображений.  
**Причины:** локальная обработка, гибкость интеграции через HTTP/gRPC.  
**Альтернативы:** внешние API (дороже и менее контролируемо).  

---

### ADR‑5: Mistral API как LLM
**Решение:** Mistral API используется для генерации рецептов.  
**Причины:** готовый внешний сервис, поддержка текстовой генерации, простая интеграция.  
**Альтернативы:** OpenAI GPT (дороже), локальные LLM (требуют больше ресурсов).  

---

### ADR‑6: SQLite как основная БД
**Решение:** SQLite используется для хранения пользователей, истории и рецептов.  
**Причины:** простота настройки, отсутствие необходимости в отдельном сервере БД, подходит для прототипа.  
**Альтернативы:** PostgreSQL (целевой вариант для продакшена), MySQL (уступает по расширенным возможностям), NoSQL (не подходит для транзакционных данных).  

---
