# D2 — Use-case Narrative

## Выбранный Use-case

**UC1 — Экономия и использование продуктов до конца**  
**Актор:** Студент с ограниченным бюджетом (Пользователь)

Пользователь вернулся с пар и хочет быстро приготовить ужин из того, что есть дома. Он не хочет тратить деньги на доставку еды и надеется использовать оставшиеся продукты, чтобы они не пропали.

---

## 1. Use-case UML Диаграмма (Диаграмма вариантов использования)
![USE-CASE_DIAGRAM](use_case.png)

**Рис. 1 - Диаграмма прецедентов (use case diagram)**



---

## 2. Happy Path (Основной успешный сценарий)

**Цель:** Пользователь получает релевантный рецепт на основе фотографии своих продуктов менее чем за 30 секунд.

**Таблица 1 - Happy Path**

| Шаг | Действие пользователя | Ответ системы | Данные/Бизнес-правила |
| :-- | :-------------------- | :------------ | :-------------------- |
| 1 | Пользователь открывает сайт. | Система отображает экран-заставку, затем главный экран с кнопкой «Сфотографировать продукты». | Пользователь авторизован, сессия активна. |
| 2 | Пользователь нажимает кнопку “Сфотографировать продукты”. | Система запрашивает разрешение на доступ к камере и к галерее (если оно не предоставлено ранее). При выборе камеры система открывает интерфейс камеры с областью для сканирования. | - |
| 3 | Пользователь делает фотографии или выбирает готовую. | Система показывает анимацию загрузки с текстом «Анализируем ваши продукты...». | Изображение сохраняется во временное хранилище. |
| 4 | *(Система)* | Система обрабатывает изображение, успешно распознаёт продукты. | Запускается ML-модель распознавания изображений на сервере. Уверенность распознавания > 75%. |
| 5 | *(Система)* | Система ищет в БД рецепты, для которых распознанные продукты являются основными. Находит несколько подходящих вариантов. | Рецепты ранжируются по рейтингу. |
| 6 | *(Система)* | Система отображает экран результатов: 3 карточки рецептов с превью, рейтингом. | Показываются только рецепты, подходящие к профилю пользователя. |
| 7 | Пользователь просматривает варианты и выбирает рецепт. | Система переходит на экран с детальным описанием рецепта: фото, время готовки, пошаговая инструкция, полный список ингредиентов. | - |

### User Value:

*   **Экономия времени:** Весь процесс от фото до рецепта занял ~20 секунд, что быстрее ручного поиска в интернете.
*   **Снижение затрат:** Пользователь использовал продукты, которые могли пропасть, и не потратил деньги на доставку.
*   **Удобство:** Минимальное взаимодействие — только фото и выбор. Нет необходимости вводить названия продуктов вручную.
*   **Снижение пищевых отходов:** Ключевая ценность проекта достигнута.

---

## 3. Alternative Flows (Альтернативные сценарии)

### A. Нет подключения к интернету

**Таблица 2 - Alternative Flows при отсутствии интернета**

| Шаг | Действие пользователя | Ответ системы |
| :-- | :-------------------- | :------------ |
| 4а | Пользователь фотографирует или выбирает изображение при отсутствии соединения. | Система проверяет connectivity. Обнаруживает отсутствие сети. |
| 5а | *(Система)* | Система показывает уведомление: «Нет соединения с интернетом. Проверьте подключение и попробуйте снова.» |
| 6а | Пользователь подключается к Wi-Fi и нажимает «Распознать» снова. | Сценарий продолжается по Happy Path. |

**User Value:** Прозрачное информирование о проблеме, а не зависшее приложение. Пользователь понимает, что делать дальше.

### B. Не удается получить доступ к камере

**Таблица 3 - Alternative Flows при отсутствии разрешения на камеру**

| Шаг | Действие пользователя | Ответ системы |
| :-- | :-------------------- | :------------ |
| 4b | Пользователь выбирает камеру в качестве источника изображения. | Система проверяет доступ к камере. Обнаруживает отсутствие разрешения к камере пользователя. |
| 5b | *(Система)* | Система показывает уведомление: «Нет доступа к камере. Проверьте, есть ли разрешение к камере и попробуйте снова.» |
| 6b | Пользователь разрешает доступ к камере и пробует заново или выбирает из галереи. | Сценарий продолжается по Happy Path. |

**User Value:** Прозрачное информирование о проблеме, а не зависшее приложение. Пользователь понимает, что делать дальше.

---

## 4. Error Handling (Обработка ошибок)

### Ошибка 1: Технический сбой на сервере (HTTP 500)

**Условие:** После нажатия «Распознать» сервер возвращает ошибку 500.

**Действие системы:**

1.  Скрыть лоадер.
2.  Отобразить состояние «Что-то пошло не так» с кнопкой «Попробовать снова».
3.  Записать ошибку в лог с `session_id`.

**User Value:** Вежливое и понятное уведомление вместо паники. Пользователь знает, что проблема временная и на нашей стороне.

### Ошибка 2: Не распознано ни одного продукта

**Условие:** ML-модель не смогла распознать продукты с уверенностью > 50%.

**Действие системы:**

1.  Отобразить экран: «Не удалось распознать продукты».
2.  Предложить действия: «Сделать новое фото».
3.  Дать подсказку по улучшению фото.

**User Value:** Конструктивная обратная связь. Пользователь не остается в тупике, а получает четкие инструкции по решению проблемы.

### Ошибка 3: Превышение лимитов запросов

**Условие:** Пользователь совершил слишком много запросов к API.

**Действие системы:**

1.  Вернуть статус `429 Too Many Requests`.
2.  Отобразить уведомление: «Слишком много запросов. Повторите через 1-2 минуты.».
3.  Заблокировать кнопку на 60 секунд.

**User Value:** Защита системы обеспечивает её стабильность для всех пользователей. Легитимный пользователь информирован о временном ограничении.
