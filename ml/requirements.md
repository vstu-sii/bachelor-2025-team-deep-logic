# Требования к модели

## Цель
- **Распознавание:** автоматическое извлечение списка продуктов с фото с помощью мультимодальной модели (VLM).
- **Генерация:** создание простых рецептов из доступных ингредиентов.
- **Фильтрация:** подбор безопасных рецептов с учётом диетических ограничений.
- **Планирование:** формирование полноценного 3-ех разового меню на один день.
- **Питательная оценка:** расчёт калорийности и КБЖУ для каждого рецепта с помощью LLM.

---

## Типы моделей и роли

### VLM для распознавания ингредиентов
- **Назначение:** анализирует изображение и возвращает список продуктов.
- **Требования:**
  - **Модель:** LLaVA.
  - **Вывод:** строгий JSON с полем `name` (название продукта).
  - **Промпт:** включает инструкцию о формате ответа.
- **Почему:** мультимодальная модель позволяет автоматически извлекать ингредиенты без ручного ввода, включая текст на упаковках и частично закрытые объекты.

### Генеративная LLM
- **Назначение:** генерирует рецепты и меню, считает КБЖУ на основе предложенного рецепта.
- **Требования:**
  - **Модель:** Gemma 3 (текстовый режим).
  - **Вывод:** строгий JSON с полем `name`, `description`, `cooking_time`, `difficulty`, `colorie_content` (название рецепта, шаги приготовления, время готовки, сложность готовки, КБЖУ).
  - **Контроль:** проверка, что в рецептах отсутствуют запрещённые ингредиенты согласно диете.
- **Почему:** LLM формирует связные рецепты и оценивает питательные значения в структурированном формате.

---

## Требования к производительности

- **Latency (задержка):**
  - UC1: ≤ 1,5 минут на распознавание продуктов.
  - UC2/UC3: ≤ 2 минут на генерацию 3-ех различных рецептов.
- **Throughput (пропускная способность):**
  - Минимум 5 одновременных пользователей без деградации качества.
- **Размер входных данных:**
  - Фото до 1–2 МБ.
  - Токены промпта + ответа ≤ 5k.

---

## Метрики качества

### VLM (распознавание ингредиентов)
- **Precision** — доля предсказанных ингредиентов, которые действительно есть в эталонном списке
- **Recall** — доля эталонных ингредиентов, которые модель правильно нашла
- **F1‑score** — баланс между точностью и полнотой
- **BLEU* — проверяет, насколько точно продукты из фото, были распознаны VLM
- **ROUGE* — проверяет, насколько много продуктов из фото, были распознаны VLM

---

## Ограничения

- **Память (архитектурная):**
  - Вся информация обрабатывается как временная (ephemeral).
  - Контекст запроса хранится только на время генерации ответа.
  - После завершения ответа данные очищаются и не используются в следующих запросах.
  - Для baseline не используется долговременная память или история диалогов.
- **Стоимость:**
  - Использовать только open-source модели.
  - Хранение данных и инференс — на локальном сервере.
- **Приватность:**
  - Фотки не должны отправляться в сторонние сервисы без согласия.
  - Обработка изображений и генерация рецептов/КБЖУ — локально или на доверенном сервере.


